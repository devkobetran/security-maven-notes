<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-node-js-security-practices" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Node.js Security | Kobe Tran | Security Notes</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://devkobetran.github.io/security-notes/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://devkobetran.github.io/security-notes/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://devkobetran.github.io/security-notes/docs/node-js-security-practices"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Node.js Security | Kobe Tran | Security Notes"><meta data-rh="true" name="description" content="Validating Data in ExpressJS"><meta data-rh="true" property="og:description" content="Validating Data in ExpressJS"><link data-rh="true" rel="icon" href="/security-notes/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://devkobetran.github.io/security-notes/docs/node-js-security-practices"><link data-rh="true" rel="alternate" href="https://devkobetran.github.io/security-notes/docs/node-js-security-practices" hreflang="en"><link data-rh="true" rel="alternate" href="https://devkobetran.github.io/security-notes/docs/node-js-security-practices" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/security-notes/blog/rss.xml" title="Kobe Tran | Security Notes RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/security-notes/blog/atom.xml" title="Kobe Tran | Security Notes Atom Feed"><link rel="stylesheet" href="/security-notes/assets/css/styles.667e145f.css">
<script src="/security-notes/assets/js/runtime~main.55d1ea06.js" defer="defer"></script>
<script src="/security-notes/assets/js/main.42246b88.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/security-notes/"><div class="navbar__logo"><img src="/security-notes/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/security-notes/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kobe Tran Security Maven Notes</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/security-notes/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/security-notes/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/devkobetran/security-maven-notes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/security-notes/docs/intro">Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/security-notes/docs/java-spring-security-practices">Java Spring Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/security-notes/docs/node-js-security-practices">Node.js Security</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/security-notes/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Node.js Security</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Node.js Security</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="validating-data-in-expressjs">Validating Data in ExpressJS<a href="#validating-data-in-expressjs" class="hash-link" aria-label="Direct link to Validating Data in ExpressJS" title="Direct link to Validating Data in ExpressJS">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-untrusted-data">WHAT IS UNTRUSTED DATA?<a href="#what-is-untrusted-data" class="hash-link" aria-label="Direct link to WHAT IS UNTRUSTED DATA?" title="Direct link to WHAT IS UNTRUSTED DATA?">​</a></h3>
<ul>
<li><strong>Untrusted data</strong> is any data that comes into your application (whether from a form on your website that a user fills out, the HTTP request headers that you receive from the browser, or even data from a database you control) that has not been vetted and validated by your application.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="where-to-validate-data">WHERE TO VALIDATE DATA<a href="#where-to-validate-data" class="hash-link" aria-label="Direct link to WHERE TO VALIDATE DATA" title="Direct link to WHERE TO VALIDATE DATA">​</a></h3>
<ul>
<li>The common places you will encounter data validation are at the client side when the request is received, and at the database layer when processing database queries.</li>
<li>You also need to implement data validation on the server side as the request is received and before anything is persisted to the database.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="validating-data-at-the-request-layer">VALIDATING DATA AT THE REQUEST LAYER<a href="#validating-data-at-the-request-layer" class="hash-link" aria-label="Direct link to VALIDATING DATA AT THE REQUEST LAYER" title="Direct link to VALIDATING DATA AT THE REQUEST LAYER">​</a></h3>
<p><code>npm install express-validator --save</code></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> bodyParser </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;body-parser&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> express </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;express&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> checkSchema</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> validationResult </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;express-validator&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bodyParser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="handling-authentication-in-nodejs-applications">Handling Authentication in NodeJS Applications<a href="#handling-authentication-in-nodejs-applications" class="hash-link" aria-label="Direct link to Handling Authentication in NodeJS Applications" title="Direct link to Handling Authentication in NodeJS Applications">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="protecting-passwords">PROTECTING PASSWORDS<a href="#protecting-passwords" class="hash-link" aria-label="Direct link to PROTECTING PASSWORDS" title="Direct link to PROTECTING PASSWORDS">​</a></h3>
<ul>
<li>Bad practices used for storing passwords, such as:<!-- -->
<ul>
<li>storing them in plaintext</li>
<li>using encryption</li>
<li>using insecure hash functions</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><ul>
<li>Passwords should never be stored using encryption.</li>
<li>If a user&#x27;s plaintext password can be retrieved (or decrypted) from the database by an application or by a database administrator, it is not being stored securely.</li>
</ul></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><ul>
<li>Cryptographic hashing algorithms such as SCrypt and BCrypt are BEST PRACTICE for protecting passwords.</li>
<li>These algorithms are “future-proof” in that they allow developers to set what is known as a work factor.</li>
<li>The work factor controls how many iterations are required by the algorithm.</li>
</ul></div></div>
<ul>
<li>Cryptographic hashing algorithms are designed to be slow.<!-- -->
<ul>
<li>When an attacker is trying to brute-force an entire database of passwords hashed using one of these functions, their efforts will slow to a crawl.</li>
<li>As cracking technology evolves, these algorithms can easily evolve as well by increasing the work factor to keep up, without changing any of the password authentication code.</li>
</ul>
</li>
</ul>
<p><code>npm install --save bcrypt</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="protecting-against-user-enumeration">PROTECTING AGAINST USER ENUMERATION<a href="#protecting-against-user-enumeration" class="hash-link" aria-label="Direct link to PROTECTING AGAINST USER ENUMERATION" title="Direct link to PROTECTING AGAINST USER ENUMERATION">​</a></h3>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><ul>
<li>Enumeration is bad practice, where different error messages are returned depending on which field was entered incorrectly. - Example: The user entered the username incorrectly, and a Hacker can know they need to focus on cracking the username first.</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="locking-user-accounts">LOCKING USER ACCOUNTS<a href="#locking-user-accounts" class="hash-link" aria-label="Direct link to LOCKING USER ACCOUNTS" title="Direct link to LOCKING USER ACCOUNTS">​</a></h3>
<ul>
<li>If an attacker knows that a user account exists, they may attempt to learn the password by performing a brute-force attack against the user&#x27;s account.</li>
<li>To prevent this kind of abuse, you need to track the number of failed attempts against an account during the authentication process.</li>
<li>By tracking the failed attempts, you can lock out further login attempts after a set number of failures.</li>
<li>The account can automatically reset after a period of time, or a manual reset can be used to re-enable the account (after the legitimate user is properly vetted, of course).</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="knowledge-check">KNOWLEDGE CHECK<a href="#knowledge-check" class="hash-link" aria-label="Direct link to KNOWLEDGE CHECK" title="Direct link to KNOWLEDGE CHECK">​</a></h4>
<ul>
<li>When storing passwords, why is bcrypt a good choice for password hashing?<!-- -->
<ul>
<li>It is designed to be slower than other hashing algorithms.</li>
</ul>
</li>
<li>True or False: Passwords should never be stored using encryption.<!-- -->
<ul>
<li>True</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="access-control-in-nodejs">Access Control in NodeJS<a href="#access-control-in-nodejs" class="hash-link" aria-label="Direct link to Access Control in NodeJS" title="Direct link to Access Control in NodeJS">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="principle-of-least-privilege-and-roles">PRINCIPLE OF LEAST PRIVILEGE AND ROLES<a href="#principle-of-least-privilege-and-roles" class="hash-link" aria-label="Direct link to PRINCIPLE OF LEAST PRIVILEGE AND ROLES" title="Direct link to PRINCIPLE OF LEAST PRIVILEGE AND ROLES">​</a></h3>
<ul>
<li>The principle of least privilege states that any process or user should have only the privileges required to carry out their tasks and no more.</li>
<li>Routine auditing of user accounts and the privileges in the system is a good defense-in-depth strategy.</li>
<li>Role-based access control:<!-- -->
<ul>
<li>Example: Customer Service, Accounting, or Admin priviledges are unique from each other.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="function-level-access-controls">FUNCTION-LEVEL ACCESS CONTROLS<a href="#function-level-access-controls" class="hash-link" aria-label="Direct link to FUNCTION-LEVEL ACCESS CONTROLS" title="Direct link to FUNCTION-LEVEL ACCESS CONTROLS">​</a></h3>
<ul>
<li>Need to perform server-side access checks to restrict specific actions.</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><ul>
<li>It is a good idea to centralize these access control checks.</li>
<li>If any bugs are discovered, they can be fixed in one place.</li>
</ul><div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>If access control checks are spread throughout the code base, it can lead to an overly complex access control code that will result in these checks being missed.</p></div></div></div></div>
<p>:::</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-control-mistakes">ACCESS CONTROL MISTAKES<a href="#access-control-mistakes" class="hash-link" aria-label="Direct link to ACCESS CONTROL MISTAKES" title="Direct link to ACCESS CONTROL MISTAKES">​</a></h3>
<ul>
<li>Examples of Mistakes:<!-- -->
<ul>
<li>forgetting to perform a check</li>
<li>only checking for a role and not privilege.</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>A good defense-in-depth strategy is to routinely audit the endpoints in the application and what roles and privileges should be required to access them: make sure that the proper access controls are in place.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="knowledge-check-1">Knowledge Check<a href="#knowledge-check-1" class="hash-link" aria-label="Direct link to Knowledge Check" title="Direct link to Knowledge Check">​</a></h4>
<ul>
<li>An API needs to be secured that supports multiple HTTP methods. Where should the access control check be performed to see if the user can access the endpoint?<!-- -->
<ul>
<li>In the all route handler</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><ul>
<li>If a single endpoint requires access control checks, it should be handled in the all route handler.</li>
<li>Even if the endpoint currently only uses the when method, handling it in the all handler will protect against mistakes in the future.</li>
<li>Additional access control checks can be performed in the individual route handlers if more fine-grained privileges are used.</li>
</ul></div></div>
<ul>
<li>True or False: Because it is typical for an application to have numerous privileges, it is best to assign those privileges individually by user.<!-- -->
<ul>
<li>False</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="session-management-in-expressjs">Session Management in ExpressJS<a href="#session-management-in-expressjs" class="hash-link" aria-label="Direct link to Session Management in ExpressJS" title="Direct link to Session Management in ExpressJS">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview">OVERVIEW<a href="#overview" class="hash-link" aria-label="Direct link to OVERVIEW" title="Direct link to OVERVIEW">​</a></h3>
<ul>
<li>One of the most important pieces of information to protect is the session identifier assigned to a user.</li>
<li>If an attacker can acquire a valid session identifier that is assigned to another user, they can use this to authenticate to the application as that user, with all of that user&#x27;s privileges.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="session-hijacking">SESSION HIJACKING<a href="#session-hijacking" class="hash-link" aria-label="Direct link to SESSION HIJACKING" title="Direct link to SESSION HIJACKING">​</a></h3>
<ul>
<li>Easiest way a session identifier can be compromised is through unintended leakage.<!-- -->
<ul>
<li>If the session identifier is being sent over an insecure channel and the user is in a situation in which an attacker can view their network traffic, then this may be the result of a <strong>person-in-the-middle (PITM) attack</strong> at a public location (for instance, a coffee shop) or someone that has access to the internal application network.</li>
<li>Since the session identifier is sent on every request, it provides an attacker with many opportunities to steal it.</li>
</ul>
</li>
<li>If the application has a <strong>cross-site scripting (XSS) vulnerability</strong>, an attacker can steal the user&#x27;s session identifier through executing JavaScript that sends the session identifier to a remote server.<!-- -->
<ul>
<li>The attacker can then use this session identifier to log in to the application as that user.</li>
<li>Fortunately, this can be easily prevented by the use of the HttpOnly flag when setting the cookie.</li>
<li>This flag will instruct the browser to allow access to the cookie only on HTTP requests.</li>
<li>If any JavaScript code, legitimate or otherwise, attempts to access the cookie, the browser will just return null.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="enabling-httponly-flag">ENABLING HTTPONLY FLAG<a href="#enabling-httponly-flag" class="hash-link" aria-label="Direct link to ENABLING HTTPONLY FLAG" title="Direct link to ENABLING HTTPONLY FLAG">​</a></h3>
<p><code>npm install express-session --save</code></p>
<p><code>npm install connect-mongo --save</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="enabling-the-secure-flag">ENABLING THE SECURE FLAG<a href="#enabling-the-secure-flag" class="hash-link" aria-label="Direct link to ENABLING THE SECURE FLAG" title="Direct link to ENABLING THE SECURE FLAG">​</a></h3>
<ul>
<li>You can prevent a cookie from being sent over an unencrypted connection by using the secure cookie flag.</li>
<li>When set, this flag tells the browser that the session cookie should never be sent over an unencrypted connection.</li>
<li>This will prevent an attacker from being able to easily eavesdrop on the network requests and steal the session identifier.</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><ul>
<li>This strategy, like all strategies, is not foolproof, but adds another layer to the security-in-depth approach.</li>
<li>If any part of the application is still using an insecure connection, this may break current functionality.</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="session-timeouts">SESSION TIMEOUTS<a href="#session-timeouts" class="hash-link" aria-label="Direct link to SESSION TIMEOUTS" title="Direct link to SESSION TIMEOUTS">​</a></h3>
<ul>
<li>Easiest safeguards is to use session timeout.</li>
<li>By implementing a session timeout, your session will automatically be destroyed after a specified period of inactivity.</li>
<li>If the user makes a request after this time, they will need to authenticate again.</li>
<li>This way, if a user on a public computer forgets to log out of the application, an attacker can&#x27;t access the app using that person&#x27;s session.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="session-fixation">SESSION FIXATION<a href="#session-fixation" class="hash-link" aria-label="Direct link to SESSION FIXATION" title="Direct link to SESSION FIXATION">​</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><ul>
<li><strong>Session fixation</strong> can occur when you recycle session identifiers.<!-- -->
<ul>
<li>For example, if a user visits your site and you set a session identifier before they log in, and then you allow them to keep the same session identifier after they authenticate to your application, you are recycling session identifiers.</li>
</ul>
</li>
</ul><div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><ul>
<li>Depending on how the vulnerable application is handling session identifiers, an attacker can create a situation in which the user will authenticate to the application but end up using a session identifier that the attacker controls.</li>
<li>This can be done through an XSS vulnerability and could, for example, be used by an attacker who has legitimate access to the application to take over an administrative account.</li>
</ul></div></div></div></div>
<p>:::</p>
<ul>
<li>To protect users from session fixation attacks, you need to assign a new session identifier to the user after they authenticate.<!-- -->
<ul>
<li>Any existing session identifier is simply ignored or invalidated, and a new one is always assigned.</li>
<li>By doing this, even if an attacker can create a situation in which the user received the session identifier that the attacker wants, the user will receive a new one after authentication, preventing the attacker from being able to access the application as the user.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="forcing-re-authentication">FORCING RE-AUTHENTICATION<a href="#forcing-re-authentication" class="hash-link" aria-label="Direct link to FORCING RE-AUTHENTICATION" title="Direct link to FORCING RE-AUTHENTICATION">​</a></h3>
<ul>
<li>You can further protect user accounts by forcing the user to re-authenticate under certain circumstances, like before changing their password or contact information.</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><ul>
<li>The ability to change this information is often exploited by attackers: after gaining access to an account, they lock the user out of their account and take control of it.</li>
<li>If the attacker has gained access to a user account through stealing a session identifier, the attacker will not know the user&#x27;s password.</li>
<li>If you require another authentication before allowing any of these changes to be made, you can prevent an attacker from taking over the account.</li>
</ul></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="knowledge-check-2">KNOWLEDGE CHECK<a href="#knowledge-check-2" class="hash-link" aria-label="Direct link to KNOWLEDGE CHECK" title="Direct link to KNOWLEDGE CHECK">​</a></h4>
<ul>
<li>The loss of a user session identifier can lead to:<!-- -->
<ul>
<li>session hijacking</li>
</ul>
</li>
<li>True or False: Session fixation can occur when you recycle session identifiers.<!-- -->
<ul>
<li>True</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="nodejs-transport-security">NodeJS Transport Security<a href="#nodejs-transport-security" class="hash-link" aria-label="Direct link to NodeJS Transport Security" title="Direct link to NodeJS Transport Security">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview-1">OVERVIEW<a href="#overview-1" class="hash-link" aria-label="Direct link to OVERVIEW" title="Direct link to OVERVIEW">​</a></h3>
<ul>
<li>One of the most important things you can do to protect your application and its users is use a secure communications layer between the user and the application.<!-- -->
<ul>
<li>This is known as <strong>Transport Layer Security (TLS)</strong> and it prevents unintended data leakage, as well as preventing an attacker from eavesdropping on your traffic.</li>
<li>Using TLS also has the added benefit of ensuring that the site you are interacting with is the authentic site, and that you are not being redirected to a fake site.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tls-ssl-and-https">TLS, SSL, AND HTTPS<a href="#tls-ssl-and-https" class="hash-link" aria-label="Direct link to TLS, SSL, AND HTTPS" title="Direct link to TLS, SSL, AND HTTPS">​</a></h3>
<ul>
<li>SSL: Secure Sockets Layer</li>
<li>Transport Layer Security (TLS) can refer to any secure communications channel and does not specify a specific protocol that must be used.</li>
<li>HTTPS is the use of HTTP over an established TLS tunnel, and is not a different protocol.</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>You should use TLS version 1.2 or later, as SSL has been deprecated due to cryptographic flaws.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="quick-question">Quick Question<a href="#quick-question" class="hash-link" aria-label="Direct link to Quick Question" title="Direct link to Quick Question">​</a></h4>
<ul>
<li>As of 2018 the NSA recommends using these transport security Methods?<!-- -->
<ul>
<li>TLS 1.2 and TLS 1.3</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="importance-of-tls">IMPORTANCE OF TLS<a href="#importance-of-tls" class="hash-link" aria-label="Direct link to IMPORTANCE OF TLS" title="Direct link to IMPORTANCE OF TLS">​</a></h3>
<ul>
<li>TLS allows you to share confidential or private data between users and your application.</li>
<li>TLS also validates that the user is interacting with the site that they intend to.</li>
<li>During the TLS handshake that establishes the secure connection, the server presents their certificate for validation by the browser through public key encryption and the use of certificate authorities.</li>
<li>The site&#x27;s certificate is checked against the list of certificate authorities that is pre-loaded into web browsers.</li>
<li>All certificates need to be signed by a trusted certificate authority; if the certificate can&#x27;t be validated, it is likely something is amiss and the site should not be trusted.</li>
<li>Along with validating who you are communicating with, TLS also provides message integrity, which ensures that the message has not been tampered with during transit.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="http-strict-transport-security-header">HTTP STRICT TRANSPORT SECURITY HEADER<a href="#http-strict-transport-security-header" class="hash-link" aria-label="Direct link to HTTP STRICT TRANSPORT SECURITY HEADER" title="Direct link to HTTP STRICT TRANSPORT SECURITY HEADER">​</a></h3>
<ul>
<li>Any time a connection is not secured, there is a chance that an attacker can see your traffic.</li>
<li>Even if you redirect the user to an HTTPS version of the application, the user could still be directed to an HTTP version if it is still supported.</li>
<li>The HTTP Strict Transport Security (HSTS) header instructs the browser to force all future connections to a site over HTTPS.</li>
<li>This prevents an attacker from directing a user to an insecure protocol (HTTP) after the user has already been to your site.</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><ul>
<li>Never serve the HSTS header over an insecure connection.</li>
<li>When redirecting the user, an HTTP 307 redirect should be used to preserve the request method (a 302 or 303 redirect is not handled properly among modern browsers due to legacy issues).</li>
<li>Once the connection is established over HTTPS, the HSTS header should always be issued.</li>
</ul></div></div>
<ul>
<li>The helmet package is a collection of middleware that adds additional HTTP headers to your application to increase security.</li>
<li>It also removes headers that might leak information, such as the X-Powered-By HTTP header.</li>
</ul>
<p><code>npm install --save helmet</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="content-security-policy">CONTENT SECURITY POLICY<a href="#content-security-policy" class="hash-link" aria-label="Direct link to CONTENT SECURITY POLICY" title="Direct link to CONTENT SECURITY POLICY">​</a></h3>
<ul>
<li>You can add an additional layer to your application’s security and take XSS mitigation much further by implementing a <strong>Content Security Policy (CSP)</strong> header.</li>
<li>This header helps reduce XSS risks, as well as other injection attacks, by allowing you to declare what dynamic resources are allowed to be loaded and where they should be loaded from.</li>
<li>You can also instruct the browser to send violations to a configured endpoint, where you can log data about the violation so that you can fix it.</li>
<li>The Content Security Policy header is a single HTTP header composed of various directives that instruct the browser as to how it should handle certain requests.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="knowledge-check-3">Knowledge Check<a href="#knowledge-check-3" class="hash-link" aria-label="Direct link to Knowledge Check" title="Direct link to Knowledge Check">​</a></h4>
<ul>
<li>A Content-Security-Policy header will aid in preventing which of the following attacks?<!-- -->
<ul>
<li>Cross-site scripting (XSS)</li>
</ul>
</li>
<li>True or False: Any time a connection is not secured, there is a chance that an attacker can see your traffic.<!-- -->
<ul>
<li>True</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pug-security-concern">Pug Security Concern<a href="#pug-security-concern" class="hash-link" aria-label="Direct link to Pug Security Concern" title="Direct link to Pug Security Concern">​</a></h2>
<ul>
<li>The most common (and default) is Pug system as a common templating system.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cross-site-scripting">CROSS-SITE SCRIPTING<a href="#cross-site-scripting" class="hash-link" aria-label="Direct link to CROSS-SITE SCRIPTING" title="Direct link to CROSS-SITE SCRIPTING">​</a></h3>
<ul>
<li>Pug will automatically escape any data to prevent injection attacks, but it also allows for user input to be inserted without escaping.</li>
<li><strong>Buffered code</strong> is started with <code>=</code> and code is HTML-escaped first:
<code>p= &#x27;This &lt;script&gt; tag will be escaped!&#x27;</code></li>
<li>Buffered code can be unescaped by using the <code>!=</code> syntax:
<code>p!= &#x27;This &lt;script&gt; tag will NOT be escaped!&#x27;</code></li>
</ul>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p>Using != is dangerous and can result in HTML injection and XSS flaws. Be careful!</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="string-interpolation">String Interpolation<a href="#string-interpolation" class="hash-link" aria-label="Direct link to String Interpolation" title="Direct link to String Interpolation">​</a></h4>
<ul>
<li>Pug provides operators for interpolating strings with variables and user data. It comes in two forms: an escaped version and an unescaped version.<!-- -->
<ul>
<li>The most common interpolation syntax, <code>#{ }</code>, performs escaping.</li>
<li>By using <code>!{ }</code> you can output unescaped HTML.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-used-templating-systems">COMMON USED TEMPLATING SYSTEMS<a href="#common-used-templating-systems" class="hash-link" aria-label="Direct link to COMMON USED TEMPLATING SYSTEMS" title="Direct link to COMMON USED TEMPLATING SYSTEMS">​</a></h3>
<ul>
<li>Hogan</li>
<li>Handlebars</li>
<li>EJS</li>
<li>Pug</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="knowledge-check-4">KNOWLEDGE CHECK<a href="#knowledge-check-4" class="hash-link" aria-label="Direct link to KNOWLEDGE CHECK" title="Direct link to KNOWLEDGE CHECK">​</a></h4>
<ul>
<li>You need to output untrusted data within an HTML div tag using Pug. Which of the following will ensure that you do not risk an XSS vulnerability?<!-- -->
<ul>
<li>Using the <code>#{}</code> operator.</li>
</ul>
</li>
<li>Pug uses different mechanisms for handling user input in templates. Which uses <code>!=</code> and can result in HTML injection?<!-- -->
<ul>
<li>Unbuffered Code</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="preventing-mongodb-query-selector-injection-attacks">Preventing MongoDB Query Selector Injection Attacks<a href="#preventing-mongodb-query-selector-injection-attacks" class="hash-link" aria-label="Direct link to Preventing MongoDB Query Selector Injection Attacks" title="Direct link to Preventing MongoDB Query Selector Injection Attacks">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview-2">OVERVIEW<a href="#overview-2" class="hash-link" aria-label="Direct link to OVERVIEW" title="Direct link to OVERVIEW">​</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><ul>
<li>NoSQL databases are more susceptible to injection attacks, as the query language being used does not feature escaping or parameterized queries. - Since there are no parameterized queries in the database engine, it is up to the developer to ensure that the NoSQL queries are constructed properly.</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="injecting-javascript">INJECTING JAVASCRIPT<a href="#injecting-javascript" class="hash-link" aria-label="Direct link to INJECTING JAVASCRIPT" title="Direct link to INJECTING JAVASCRIPT">​</a></h3>
<ul>
<li>The following commands and operators all allow arbitrary JavaScript expressions to be executed on the server<!-- -->
<ul>
<li><code>$where</code> operator</li>
<li>mapReduce command</li>
<li>group command</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><ul>
<li>An attacker who can influence what is being passed into these commands or operators can leverage this to interact with the database. - And even gain remote access to the server itself.</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="injecting-operators">INJECTING OPERATORS<a href="#injecting-operators" class="hash-link" aria-label="Direct link to INJECTING OPERATORS" title="Direct link to INJECTING OPERATORS">​</a></h3>
<ul>
<li>Depending on how the query to MongoDB is being handled, if input is not sanitized, you run the risk of an attacker injecting query modifiers into your code.<!-- -->
<ul>
<li>In order to prevent this, you need to sanitize the request.</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="knowledge-check-5">KNOWLEDGE CHECK<a href="#knowledge-check-5" class="hash-link" aria-label="Direct link to KNOWLEDGE CHECK" title="Direct link to KNOWLEDGE CHECK">​</a></h4>
<ul>
<li>Which of the following can prevent a potential injection attack when building a query from a deserialized JSON object?<!-- -->
<ul>
<li>Using mongo-sanitize to sanitize the data</li>
</ul>
</li>
<li>True or False: NoSQL databases are NOT susceptible to injection attacks.<!-- -->
<ul>
<li>False</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="managing-third-party-dependencies">Managing Third-Party Dependencies<a href="#managing-third-party-dependencies" class="hash-link" aria-label="Direct link to Managing Third-Party Dependencies" title="Direct link to Managing Third-Party Dependencies">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview-3">OVERVIEW<a href="#overview-3" class="hash-link" aria-label="Direct link to OVERVIEW" title="Direct link to OVERVIEW">​</a></h3>
<ul>
<li>Dependencies need to be updated due to security risks</li>
<li>Backwards compatibility and breaking changes are also issues that need to be taken into account.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="unused-packages">UNUSED PACKAGES<a href="#unused-packages" class="hash-link" aria-label="Direct link to UNUSED PACKAGES" title="Direct link to UNUSED PACKAGES">​</a></h3>
<ul>
<li>You can use the depcheck tool to determine what dependencies you are relying on that are no longer being used:</li>
</ul>
<p><code>npm install -g depcheck</code></p>
<ul>
<li>Running this from the project folder location will scan your dependencies and display all of your unused dependencies</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="package-popularity">PACKAGE POPULARITY<a href="#package-popularity" class="hash-link" aria-label="Direct link to PACKAGE POPULARITY" title="Direct link to PACKAGE POPULARITY">​</a></h3>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Packages that are not very popular or seldom used should be avoided if possible.</p></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>If the package is not in common use, it is likely that any security vulnerabilities discovered in it may not get fixed, or may go undiscovered.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="check-for-outdated-packages">CHECK FOR OUTDATED PACKAGES<a href="#check-for-outdated-packages" class="hash-link" aria-label="Direct link to CHECK FOR OUTDATED PACKAGES" title="Direct link to CHECK FOR OUTDATED PACKAGES">​</a></h3>
<ul>
<li>Packages should be updated on a regular basis.</li>
<li>Dealing with package updates should be part of the normal development lifecycle.</li>
<li>Packages that are not updated regularly run the risk of keeping the application in a legacy state that will require more effort to update at a later time.</li>
<li>There is also the danger that a fix for a security vulnerability may not get backported to old versions of a package, leaving your application at risk of attack.</li>
<li>You can view the outdated packages using npm via the outdated command</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm outdated</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="check-for-old-packages">CHECK FOR OLD PACKAGES<a href="#check-for-old-packages" class="hash-link" aria-label="Direct link to CHECK FOR OLD PACKAGES" title="Direct link to CHECK FOR OLD PACKAGES">​</a></h3>
<ul>
<li>Packages that haven&#x27;t been updated in a long time also present a problem.</li>
<li>It&#x27;s common for package maintainers to move onto other projects, or simply lose interest in maintaining a package.</li>
<li>This means maintainers may be slow to add new functionality or fix security issues.</li>
<li>You can view the last time a package was updated using the <code>npm view</code> command.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="check-for-known-vulnerabilities">CHECK FOR KNOWN VULNERABILITIES<a href="#check-for-known-vulnerabilities" class="hash-link" aria-label="Direct link to CHECK FOR KNOWN VULNERABILITIES" title="Direct link to CHECK FOR KNOWN VULNERABILITIES">​</a></h3>
<ul>
<li>It&#x27;s also important to ensure that you are not using any packages that currently have known vulnerabilities in them.</li>
<li>Npm now does provide built-in functionality to track this type of information:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm audit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-a-private-repository">RUN A PRIVATE REPOSITORY<a href="#run-a-private-repository" class="hash-link" aria-label="Direct link to RUN A PRIVATE REPOSITORY" title="Direct link to RUN A PRIVATE REPOSITORY">​</a></h3>
<ul>
<li>All the packages that npm uses are stored and accessed on the public npm repository.</li>
<li>This creates a dependency on an external source.</li>
<li>A package being removed can leave builds in a broken state.<!-- -->
<ul>
<li>For this reason and in order to always be able to produce reproducible builds, it may be advantageous to run a private repository or use a paid plan with npm or a third-party self-hosted solution.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="nodejs-security-assessment">Node.js Security Assessment<a href="#nodejs-security-assessment" class="hash-link" aria-label="Direct link to Node.js Security Assessment" title="Direct link to Node.js Security Assessment">​</a></h2>
<ul>
<li>Which of the following does NOT allow JavaScript to be injected in it?<!-- -->
<ul>
<li>$text operators</li>
</ul>
</li>
<li>True or False: While SSL has been replaced by TLS, you can still use SSL safely.<!-- -->
<ul>
<li>False</li>
</ul>
</li>
<li>The principle of least privilege states that:<!-- -->
<ul>
<li>All users or processes should have the least amount of access possible</li>
</ul>
</li>
<li>True or False: Assigning privileges to a specific position like “Administrator” is known as role-based access control.<!-- -->
<ul>
<li>True</li>
</ul>
</li>
<li>The node package manager (npm) is NOT able to:<!-- -->
<ul>
<li>Find packages with known vulnerabilities.</li>
</ul>
</li>
<li>True or False: It can be extremely convenient to run JavaScript expressions using commands, but they also pose a huge security risk.<!-- -->
<ul>
<li>True</li>
</ul>
</li>
<li>Where should data be validated?<!-- -->
<ul>
<li>Any time data passes a trust boundary</li>
</ul>
</li>
<li>Which function you can use to determine the last time a package was updated?<!-- -->
<ul>
<li><code>npm view</code></li>
</ul>
</li>
<li>Which is the BEST description of authentication?<!-- -->
<ul>
<li>A process that establishes that a user is who they say they are</li>
</ul>
</li>
<li>Which of the following automatically destroys a session after a specified period of inactivity?<!-- -->
<ul>
<li>Session Timeout</li>
</ul>
</li>
<li>True or False: It is safe for your content management system to allow users to add snippets of template code and preview it.<!-- -->
<ul>
<li>False</li>
</ul>
</li>
<li>True or False: Because all data on the client side is untrusted, performing validation on the client side is ineffective.<!-- -->
<ul>
<li>False</li>
</ul>
</li>
<li>The ability of an attacker to identify whether an account exists is an example of:<!-- -->
<ul>
<li>User account enumeration</li>
</ul>
</li>
<li>The Secure HTTP cookie flag prevents:<!-- -->
<ul>
<li>The cookie from being sent over plaintext HTTP.</li>
</ul>
</li>
<li>Using TLS will NOT:<!-- -->
<ul>
<li>Encrypt data at rest.</li>
</ul>
</li>
<li>Which Pug operator will perform output encoding on user data?<!-- -->
<ul>
<li>The #<!-- --> operator</li>
</ul>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/devkobetran/security-maven-notes/docs/node-js-security-practices.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/security-notes/docs/java-spring-security-practices"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Java Spring Security</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#validating-data-in-expressjs" class="table-of-contents__link toc-highlight">Validating Data in ExpressJS</a><ul><li><a href="#what-is-untrusted-data" class="table-of-contents__link toc-highlight">WHAT IS UNTRUSTED DATA?</a></li><li><a href="#where-to-validate-data" class="table-of-contents__link toc-highlight">WHERE TO VALIDATE DATA</a></li><li><a href="#validating-data-at-the-request-layer" class="table-of-contents__link toc-highlight">VALIDATING DATA AT THE REQUEST LAYER</a></li></ul></li><li><a href="#handling-authentication-in-nodejs-applications" class="table-of-contents__link toc-highlight">Handling Authentication in NodeJS Applications</a><ul><li><a href="#protecting-passwords" class="table-of-contents__link toc-highlight">PROTECTING PASSWORDS</a></li><li><a href="#protecting-against-user-enumeration" class="table-of-contents__link toc-highlight">PROTECTING AGAINST USER ENUMERATION</a></li><li><a href="#locking-user-accounts" class="table-of-contents__link toc-highlight">LOCKING USER ACCOUNTS</a></li></ul></li><li><a href="#access-control-in-nodejs" class="table-of-contents__link toc-highlight">Access Control in NodeJS</a><ul><li><a href="#principle-of-least-privilege-and-roles" class="table-of-contents__link toc-highlight">PRINCIPLE OF LEAST PRIVILEGE AND ROLES</a></li><li><a href="#function-level-access-controls" class="table-of-contents__link toc-highlight">FUNCTION-LEVEL ACCESS CONTROLS</a></li><li><a href="#access-control-mistakes" class="table-of-contents__link toc-highlight">ACCESS CONTROL MISTAKES</a></li></ul></li><li><a href="#session-management-in-expressjs" class="table-of-contents__link toc-highlight">Session Management in ExpressJS</a><ul><li><a href="#overview" class="table-of-contents__link toc-highlight">OVERVIEW</a></li><li><a href="#session-hijacking" class="table-of-contents__link toc-highlight">SESSION HIJACKING</a></li><li><a href="#enabling-httponly-flag" class="table-of-contents__link toc-highlight">ENABLING HTTPONLY FLAG</a></li><li><a href="#enabling-the-secure-flag" class="table-of-contents__link toc-highlight">ENABLING THE SECURE FLAG</a></li><li><a href="#session-timeouts" class="table-of-contents__link toc-highlight">SESSION TIMEOUTS</a></li><li><a href="#session-fixation" class="table-of-contents__link toc-highlight">SESSION FIXATION</a></li><li><a href="#forcing-re-authentication" class="table-of-contents__link toc-highlight">FORCING RE-AUTHENTICATION</a></li></ul></li><li><a href="#nodejs-transport-security" class="table-of-contents__link toc-highlight">NodeJS Transport Security</a><ul><li><a href="#overview-1" class="table-of-contents__link toc-highlight">OVERVIEW</a></li><li><a href="#tls-ssl-and-https" class="table-of-contents__link toc-highlight">TLS, SSL, AND HTTPS</a></li><li><a href="#importance-of-tls" class="table-of-contents__link toc-highlight">IMPORTANCE OF TLS</a></li><li><a href="#http-strict-transport-security-header" class="table-of-contents__link toc-highlight">HTTP STRICT TRANSPORT SECURITY HEADER</a></li><li><a href="#content-security-policy" class="table-of-contents__link toc-highlight">CONTENT SECURITY POLICY</a></li></ul></li><li><a href="#pug-security-concern" class="table-of-contents__link toc-highlight">Pug Security Concern</a><ul><li><a href="#cross-site-scripting" class="table-of-contents__link toc-highlight">CROSS-SITE SCRIPTING</a></li><li><a href="#common-used-templating-systems" class="table-of-contents__link toc-highlight">COMMON USED TEMPLATING SYSTEMS</a></li></ul></li><li><a href="#preventing-mongodb-query-selector-injection-attacks" class="table-of-contents__link toc-highlight">Preventing MongoDB Query Selector Injection Attacks</a><ul><li><a href="#overview-2" class="table-of-contents__link toc-highlight">OVERVIEW</a></li><li><a href="#injecting-javascript" class="table-of-contents__link toc-highlight">INJECTING JAVASCRIPT</a></li><li><a href="#injecting-operators" class="table-of-contents__link toc-highlight">INJECTING OPERATORS</a></li></ul></li><li><a href="#managing-third-party-dependencies" class="table-of-contents__link toc-highlight">Managing Third-Party Dependencies</a><ul><li><a href="#overview-3" class="table-of-contents__link toc-highlight">OVERVIEW</a></li><li><a href="#unused-packages" class="table-of-contents__link toc-highlight">UNUSED PACKAGES</a></li><li><a href="#package-popularity" class="table-of-contents__link toc-highlight">PACKAGE POPULARITY</a></li><li><a href="#check-for-outdated-packages" class="table-of-contents__link toc-highlight">CHECK FOR OUTDATED PACKAGES</a></li><li><a href="#check-for-old-packages" class="table-of-contents__link toc-highlight">CHECK FOR OLD PACKAGES</a></li><li><a href="#check-for-known-vulnerabilities" class="table-of-contents__link toc-highlight">CHECK FOR KNOWN VULNERABILITIES</a></li><li><a href="#run-a-private-repository" class="table-of-contents__link toc-highlight">RUN A PRIVATE REPOSITORY</a></li></ul></li><li><a href="#nodejs-security-assessment" class="table-of-contents__link toc-highlight">Node.js Security Assessment</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/security-notes/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/security-notes/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/devkobetran/security-maven-notes" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Kobe Tran Security Maven Notes. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>